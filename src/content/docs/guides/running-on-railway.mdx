---
title: 在 Railway 上运行
---

[Railway](https://railway.app/) 正在尝试为人类构建软件开发基础设施。它的核心理念是构建软件应该是“取所需，弃所不”，并且当前的软件开发工具远比现阶段的开发者所需的复杂，更不用提未来的新一代开发者了。因此，Railway 处理您的构建、部署、扩展和基础设施管理；从开发到生产！

Railway 提供免费的托管服务，允许您部署 Umami 并设置一个 PostgreSQL 数据库，这样您只需一键即可拥有自托管版本。

## 设置网站和数据库

### Railway 按钮（推荐）

[![在 Railway 上部署](https://railway.app/button.svg)](https://railway.app/new/template/umami-analytics)

点击上面的按钮以便部署您自托管的 Umami 网站，连同一个自动配置的 PostgreSQL 数据库。

现在您应该可以访问您的 Umami 仪表板，并设置您想要跟踪分析的网站。

您可以通过运行 `railway open` 找到可以访问的项目仪表板 URL。

## 从一个派生的代码库在 Railway 上运行

之前描述的方法是让 Umami 在 Railway 上运行的最快和最简单的方法。然而，您可能希望使用一个分叉的代码库，以便能够方便地通过 GitHub 接收 Umami 源代码库的更新（或向其贡献拉取请求）。

### 设置 Railway 项目

1. 派生 [Umami 仓库](https://github.com/umami-software/umami)。
1. 创建一个与 GitHub 连接的 [Railway 账户](https://railway.app/)。
1. 如果愿意，您可以在链接 GitHub 账户时仅给予 Railway 对您 Umami 派生库的权限。
1. 在仪表板页面点击 **新项目 > 从代码库部署**。
1. 选择您派生的 Umami 仓库，并选择 **master** 分支。
1. 添加一个名为 `PORT` 的第二个变量，设置其值为有效的端口号（例如: `3000`）。点击 **添加**。
1. 添加一个名为 `DATABASE_TYPE` 的第三个变量，设置其值为 `postgres`。点击 **添加**。
1. 添加一个名为 `HOSTNAME` 的第四个变量，设置其值为 `0.0.0.0`。点击 **添加**。
1. 点击 **部署**。

在您完成其余步骤之前，这次初始部署将会失败。

### 数据库和部署

1. 关闭设置侧边栏，点击 **新建**，点击 **数据库** 并选择 **添加 PostgreSQL**。
1. 在仪表板上，选择您的 Umami 服务，进入 **变量** 选项卡并点击 **新变量**。
1. 点击 **添加引用** 并选择来自 Postgres 数据库的 `DATABASE_URL` 变量。点击 **添加**。

添加数据库后应触发重新部署，点击应用链接应能让您到达 Umami 实例的登录页面。

### 故障排除

如果 Railway 在您的仪表板中显示 `您的项目没有部署`。

1. 在左下角选择 `在本地设置项目`。

2. 在 `umami` 根目录中，按照弹出窗口中的说明进行操作。

- 使用 `railway login` 登录您的 Railway 账户
- 使用 `railway link` 关联您的项目
- 使用 `railway open` 打开您的项目仪表板
- 使用 `railway up` 上传并部署您的项目

3. 从 [登录](/docs/login) 步骤开始，按照 **开始使用** 指南进行操作，并确保更改默认密码。

### 注意事项

- 在这里了解有关 [添加网站](https://umami.is/docs/add-a-website) 和 [收集数据](https://umami.is/docs/collect-data) 的更多信息