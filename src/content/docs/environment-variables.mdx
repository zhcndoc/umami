---
title: 环境变量
---

您可以使用环境变量配置 Umami。它们与您的 `DATABASE_URL` 一起放在同一个 `.env` 文件中。

---

## 运行时变量

运行时变量在 Umami 运行时被识别。您可以在启动应用程序之前设置环境变量。

**APP_SECRET = &lt;随机字符串&gt;**

您安装的唯一值。

**CLIENT_IP_HEADER = &lt;头部名称&gt;**

用于检查客户端 IP 地址的 HTTP 头部。当您位于使用非标准头部的代理后面时，这很有用。

**CLOUD_MODE = 1**

禁用 `users`、`teams` 和 `websites` 设置页面。

**COLLECT_API_ENDPOINT = &lt;API 端点&gt;**

允许您将指标发送到不同于默认的 `/api/send` 的位置。这可以帮助您避免一些 [广告拦截器](/docs/bypass-ad-blockers)。

**CORS_MAX_AGE = &lt;数字&gt;**

CORS 预检请求的持续时间（秒）。默认值为 24 小时。

**DATABASE_URL = &lt;连接字符串&gt;**

您数据库的连接字符串。这是唯一必需的变量。

**DEBUG = &lt;调试值&gt;**

控制台记录应用程序特定区域的日志。值包括 `umami:auth`、`umami:clickhouse`、`umami:kafka`、`umami:middleware` 和 `umami:prisma`。

**DISABLE_BOT_CHECK = 1**

默认情况下，机器人被排除在统计数据之外。此设置禁用对机器人的检查。

**DISABLE_LOGIN = 1**

禁用应用程序的登录页面。

**DISABLE_UPDATES = 1**

禁用检查 Umami 的新版本。

**DISABLE_TELEMETRY = 1**

Umami 收集完全匿名的遥测数据，以帮助改进应用程序。如果您不希望参与，可以选择禁用此功能。

**ENABLE_TEST_CONSOLE = 1**

启用内部测试页面，`{host}/console`。需要管理员访问权限。用户可以手动在其网站上触发页面浏览和事件。

**HOSTNAME = &lt;主机名&gt;** / **PORT = &lt;端口号&gt;**

如果您在需要绑定特定主机名或端口的环境中运行，例如 Heroku，您可以添加这些变量，并使用 `npm run start-env` 启动应用程序，而不是 `npm start`。

**IGNORE_IP = &lt;ip 地址或范围&gt;**

您可以提供一个以逗号分隔的 IP 地址和范围列表，以排除在数据收集之外。

**LOG_QUERY = 1**

如果您在开发模式中运行，这将把数据库查询记录到控制台以供调试。

**PRIVATE_MODE = 1**

禁用所有外部网络调用。注意，这也会禁用所有网站图标，因为它们来自 duckduckgo.com。

**REMOVE_TRAILING_SLASH = 1**

从所有传入 URL 中移除尾部斜杠。

**TRACKER_SCRIPT_NAME = &lt;脚本名称&gt;**

允许您为跟踪脚本分配一个自定义名称，区别于默认的 `script.js`。这可以帮助您避免一些 [广告拦截器](/docs/bypass-ad-blockers)。

`.js` 扩展名不是必需的。值也可以是您选择的任何路径，例如 `/path/to/tracker`。

---

## 构建时变量

构建时变量仅在构建过程中被识别。这也包括构建自定义 Docker 镜像。您需要在构建应用程序之前设置环境变量。

**ALLOWED_FRAME_URLS = &lt;urls&gt;**

允许以 iframe 托管应用程序的 URL 的空格分隔列表。

**BASE_PATH = &lt;路径&gt;**

如果您想在子目录下托管 Umami，您可能需要更新您的反向代理设置以正确处理 BASE_PATH 前缀。

**DATABASE_TYPE = &lt;postgresql | mysql&gt;**

要使用的数据库类型。这仅在 Docker 构建时是必需的。

**FORCE_SSL = 1**

这会在所有请求中发送 HTTP `Strict-Transport-Security` 响应头。请参见 [https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security)。

**SKIP_DB_CHECK = 1**

跳过构建过程中的 `check-db` 步骤。用于 Docker 构建。