---
title: 在 CapRover 上运行
---

[CapRover](https://caprover.com) 是一个非常易用的应用/数据库部署及 Web 服务器管理工具，适用于你的 NodeJS、Python、PHP、ASP.NET、Ruby、MySQL、MongoDB、PostgreSQL、WordPress（等等）应用！
它极其快速且非常稳定，因为它在简洁易用的界面下，底层使用了 Docker、nginx、LetsEncrypt 和 NetData。

- 命令行界面（CLI）支持自动化和脚本操作
- Web 图形界面方便访问和使用
- 无锁定！移除 CapRover 后你的应用仍能正常运行！
- 底层使用 Docker Swarm 实现容器化和集群管理
- 底层使用 Nginx（完全可定制模板）实现负载均衡
- 底层使用 Let’s Encrypt 提供免费 SSL（HTTPS）

## 安装

在 CapRover 上安装 Umami 非常简单。请按照下面步骤在 CapRover 上设置 Umami：

### 1. 访问你的 CapRover 控制面板

登录到你已有的 CapRover 实例账户，地址格式为 `captain.your-sub-domain.your-domain.xx`。

如果你还没有 CapRover 实例，请参考官方文档：[CapRover - 入门指南](https://caprover.com/docs/get-started.html)。

### 2. 从模板创建应用

点击你的 CapRover 实例中的“Apps”部分。
然后选择“One-Click Apps/Databases”并搜索 Umami，你会看到三个选项：

- `umami_postgresql`：使用 PostgreSQL 数据库创建 Umami。
- `umami_mysql`：使用 MySQL 数据库创建 Umami。
- `umami_only`：只创建 Umami 应用，数据库服务需要你自行搭建，并在设置中提供数据库凭据。

### 3. 搭配数据库设置 Umami

选择 CapRover 的 `umami_postgresql` 或 `umami_mysql` 后，会弹出设置页面，可以填写部分环境变量。大部分内容已经预配置。

- `App Name` 是你在 CapRover 中显示的 Umami 实例名称。
- `PostgreSQL or MySQL Version` 可以是 [PostgreSQL - Docker Hub](https://hub.docker.com/_/postgres) 或 [MySQL - Docker Hub](https://hub.docker.com/_/mysql) 上支持的任何版本。默认值已通过测试与 Umami 兼容。
- `CapRover Umami Version` 指的是 CapRover Umami 的最新版本，见 [Umami release page](https://github.com/umami-software/umami/releases)。CapRover Umami 会使用官方为你选择的数据库发布的 Docker 镜像。你可以输入具体的版本号（如 `v.1.33.x`），也可以填 `latest` 使用最新版本。
- `Database password` 是数据库使用的密码，系统会预设一个默认值。
- 可选项：`Arguments for 'PostgreSQL initdb'`，你可以提供 PostgreSQL initdb 的参数，例如 `--data-checksums`，该选项仅对 `umami_postgresql` 生效。

填写完成后，点击“Deploy”开始部署 CapRover Umami 实例和数据库服务。
请部署完成前不要离开页面。

### 4. 不使用数据库服务设置 Umami

某些情况下你可能想自行管理数据库服务，或者使用远程数据库服务为 Umami 提供数据存储。这时可以使用 `umami_only` CapRover 应用。

在设置此应用前，你需先搭建好 MySQL 或 PostgreSQL 数据库服务。

完成数据库搭建后，选择 CapRover 中的 `umami_only`，并填写以下变量：

- `App Name` 是你在 CapRover 中显示的 Umami 实例名称。
- `CapRover Umami Version` 参照 [Umami release page](https://github.com/umami-software/umami/releases) 上的最新版本。CapRover Umami 会使用官方发布的针对你选择数据库的 Docker 镜像。可填写版本号（如 `v.1.33.x`）或用 `latest` 获取最新版本。
- `Database Type` 设为 `postgresql` 或 `mysql`，匹配你的数据库类型。
- `Database Remote URL` 是 Umami 用于连接数据库的远程地址。如果数据库在你的 CapRover 网络内，请用 `srv-captain--appName` 的格式。
- `Database User` 是数据库用户名。
- `Database Table` 是你为 Umami 创建的数据库表。
- `Database Password` 是数据库密码。

填写完成后，点击“Deploy”开始部署 CapRover Umami 实例。
请部署完成前不要关闭页面。

### 5. 最后检查

现在你可以访问 `app-name.your-sub-domain.your-domain.xx` 登录你的 Umami 部署，具体见 [Login](/docs/login) 部分。
请务必在个人资料页面立即更改密码。

### 6. 更新已有的 Umami 实例

更新前先备份数据库。备份完成后，进入 CapRover 面板，选择你的 Umami 应用。
打开 `Deployment` 标签页，向下滚动到 `Deploy via ImageName` 部分，部署你想要的版本，镜像可在 [Umami Docker Registry](https://github.com/umami-software/umami/pkgs/container/umami) 找到。

注意：请根据你的数据库选择正确的 Docker 镜像。通常 MySQL 镜像前缀为 `mysql_`，PostgreSQL 镜像前缀为 `postgresql_`。

## 支持

请在 [GitHub](https://github.com/caprover/one-click-apps/issues) 上提交 issue。