---
title: 在 Vercel 上运行
---

[Vercel](https://vercel.com/) 是开发框架 [Next.js](https://nextjs.org/) 的公司，Umami 也使用该框架。  
他们还提供了一个免费托管服务，非常适合 Next.js 应用程序。

如果你还没有数据库，可以创建一个 Vercel Postgres 数据库集成。你也可以  
参考 [在 DigitalOcean 上运行](/docs/running-on-digitalocean) 指南或  
[在 PlanetScale 上运行](/docs/running-on-planetscale) 指南来启动数据库。  
你还可以查看 [托管](/docs/guides/hosting) 中的 **托管数据库** 部分。

## 设置

[![使用 Vercel 部署](https://vercel.com/button)](https://vercel.com/new/clone?repository-url=https%3A%2F%2Fgithub.com%2Fumami-software%2Fumami&env=DATABASE_URL)

_使用上方按钮自动执行步骤 1-5_

1. 将项目 [https://github.com/umami-software/umami](https://github.com/umami-software/umami) fork 到你的 GitHub 账号。
2. 在 [Vercel](https://vercel.com/) 创建一个账户。
3. 在仪表盘页面点击 **Import Project**，然后指定你 fork 的 GitHub 项目 URL。
4. 给你的 Vercel 项目添加必需的环境变量 `DATABASE_URL`。这些值在 [安装](/docs/install) 的 **配置 Umami** 步骤中定义。你也可以在此时创建一个 Vercel Postgres 数据库。

- 你应该为 umami 使用 `POSTGRES_PRISMA_URL`，其格式为 `postgres://user:passwd@endpoint-pooler.postgres.vercel-storage.com/verceldb?pgbouncer=true&connect_timeout=10`。
- 用于数据库 URL 的环境变量可以在 `db/postgresql/prisma.schema` 文件中更改。

5. 部署并访问你的应用，地址为 `<deploy-id>.vercel.app`。
6. 按照 [登录](/docs/login) 步骤开始 **快速开始** 指南，并确保更改默认密码。

### 通过 Vercel 代理 Umami Analytics

你可以选择通过代理 Umami Analytics，将其从你的主域名提供服务。当使用 [Umami Cloud](https://umami.is/pricing) 时，这也有助于绕过广告拦截器。

参见 Vercel 的 [重写文档](https://vercel.com/docs/project-configuration)。

在你的项目根目录下，添加一个 `vercel.json` 文件，内容如下：

```json
{
  "rewrites": [
    {
      "source": "/stats/:match*",
      "destination": "https://cloud.umami.is/:match*"
    }
  ]
}
```

跟踪代码的 `<script>` 标签应将 `src` 设置为 `/stats/script.js`：

```html
<script
  defer
  src="/stats/script.js"
  data-website-id="94db1cb1-74f4-4a40-ad6c-962362670409"
></script>
```