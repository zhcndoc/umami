---
title: 安装
---

安装 Umami 有几种不同的方法。

- **从源码安装**：从 [GitHub](https://github.com/umami-software/umami) 获取代码，自己构建应用。
- **使用 Docker Compose**：使用 `docker compose` 构建自己的 Docker 容器。
- **使用 Docker 镜像**：下载预先构建好的 Docker 镜像。

## 从源码安装

### 需求

- 一台服务器，安装了版本 18.18 或更高的 [Node.js](https://nodejs.org/)。
- 一个数据库。Umami 支持 [PostgreSQL](https://www.postgresql.org/)（最低版本 v12.14）数据库。

- **注意**：建议配置 PostgreSQL 数据库使用 **UTC** 时区。

    **为什么使用 UTC？**

    使用 UTC 避免由于地区时差带来的问题，确保在不同环境、服务和部署之间的时间戳一致且可预测。


### 安装 pnpm

```shell
npm install -g pnpm
```

### 获取源码并安装依赖

```shell
git clone https://github.com/umami-software/umami.git
cd umami
pnpm install
```

### 配置 Umami

新建一个 `.env` 文件，内容如下：

```dotenv
DATABASE_URL={连接地址}
```

连接地址格式如下：

```dotenv
DATABASE_URL=postgresql://username:mypassword@localhost:5432/mydb
```

### 构建应用

```shell
pnpm build
```

首次构建时，会在数据库中创建所有必需的数据表。
同时会创建一个登录账号，用户名为 **admin**，密码为 **umami**。

### 启动应用

```shell
pnpm start
```

默认情况下，应用会启动在 `http://localhost:3000`。
你需要要么从你的 web 服务器[代理请求](https://docs.nginx.com/nginx/admin-guide/web-server/reverse-proxy/)，
要么更改[端口](https://nextjs.org/docs/api-reference/cli#production)，以便直接服务该应用。

### 运行 Umami

你可以直接运行 `pnpm start` 来启动 Umami，但强烈推荐使用像 [PM2](https://pm2.keymetrics.io/) 这样的进程管理器来管理重启等操作。

使用 PM2 运行：

```shell
pnpm --global add pm2
cd umami
pm2 start "pnpm start" --name umami
pm2 startup
pm2 save
```

## 使用 Docker 安装

Umami 提供了一个包含应用程序和 PostgreSQL 数据库的 docker compose 配置。

要构建 Docker 容器并启用 Postgres 数据库，运行：

```shell
docker-compose up -d
```

或者，如果你想使用预构建的镜像，可以拉取带 PostgreSQL 支持的 Umami Docker 镜像：

```shell
docker pull docker.umami.is/umami-software/umami:postgresql-latest
```
